{"ast":null,"code":"var _jsxFileName = \"D:\\\\Program Files (x86)\\\\GitHub\\\\MyCardGame\\\\webSocketsPrototype\\\\reack-client\\\\src\\\\components\\\\SearchingPage.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport SockJS from 'sockjs-client';\nimport { over } from 'stompjs';\nimport { useDispatch } from 'react-redux';\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar serverURL = 'http://localhost:8082';\nvar stompClient = null;\nvar gameID = \"\";\nconst SearchingPage = () => {\n  _s();\n  const [userName, setUserName] = useState(\"\");\n  const [isConnected, setIsConnected] = useState(false);\n  const [isEnemyFound, setIsEnemyFound] = useState(false);\n  const [points, setPoints] = useState(0);\n  const [enemyPoints, setEnemyPoints] = useState(0);\n  const dispatch = useDispatch();\n  let navigate = useNavigate();\n  const connectToServer = () => {\n    dispatch({\n      type: \"CHANGE_NAME\",\n      payload: userName\n    });\n    dispatch({\n      type: \"SET_SERVER_URL\",\n      payload: serverURL\n    });\n    let Sock = new SockJS(serverURL + '/ws');\n    stompClient = over(Sock);\n    stompClient.connect({}, onConnected);\n  };\n  const onConnected = () => {\n    setIsConnected(true);\n    stompClient.subscribe('/user/' + userName + '/private', onMessageReceived);\n  };\n  const onMessageReceived = payload => {\n    if (payload.body.includes(\"Found enemy\")) {\n      gameID = payload.body.split(\":\")[1];\n      dispatch({\n        type: \"SET_GAME_ID\",\n        payload: gameID\n      });\n      let message = userName + \":\" + gameID;\n      setIsEnemyFound(true);\n      fetch(serverURL + '/button', {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'text/plain'\n        },\n        body: message\n      });\n      navigate(\"/game\");\n    } else if (payload.body.includes(\"Get data from server\")) {\n      let enemyName = payload.body.split(\":\")[1];\n      fetch(serverURL + `/button/getPoints/${enemyName}/${gameID}`).then(res => res.json()).then(data => {\n        setEnemyPoints(data);\n      }).catch(console.error);\n    }\n  };\n  const startSearching = () => {\n    stompClient.send('/app/findEnemy', {}, userName);\n  };\n  const increase = () => {\n    let message = userName + \":\" + gameID;\n    fetch(serverURL + '/button', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'text/plain'\n      },\n      body: message\n    });\n    fetch(serverURL + `/button/getPoints/${userName}/${gameID}`).then(res => res.json()).then(data => {\n      setPoints(data);\n    }).catch(console.error);\n    stompClient.send('/app/sendToEnemy', {}, userName);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: isEnemyFound ? /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [!isConnected ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"connect to search\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 22\n      }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: startSearching,\n        children: \"search for opponent\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 52\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: isConnected ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: \" \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 23\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            id: \"user-name\",\n            placeholder: \"enter user name\",\n            value: userName,\n            name: \"username\",\n            onChange: event => {\n              setUserName(event.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 10\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: connectToServer,\n            children: \"connect to server\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 10\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 5\n  }, this);\n};\n_s(SearchingPage, \"acJHUAaXyLJdm68f+TcluN7mGLk=\", false, function () {\n  return [useDispatch, useNavigate];\n});\n_c = SearchingPage;\nexport default SearchingPage;\nvar _c;\n$RefreshReg$(_c, \"SearchingPage\");","map":{"version":3,"names":["React","useState","SockJS","over","useDispatch","useNavigate","jsxDEV","_jsxDEV","serverURL","stompClient","gameID","SearchingPage","_s","userName","setUserName","isConnected","setIsConnected","isEnemyFound","setIsEnemyFound","points","setPoints","enemyPoints","setEnemyPoints","dispatch","navigate","connectToServer","type","payload","Sock","connect","onConnected","subscribe","onMessageReceived","body","includes","split","message","fetch","method","headers","enemyName","then","res","json","data","catch","console","error","startSearching","send","increase","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","id","placeholder","value","name","onChange","event","target","_c","$RefreshReg$"],"sources":["D:/Program Files (x86)/GitHub/MyCardGame/webSocketsPrototype/reack-client/src/components/SearchingPage.tsx"],"sourcesContent":["import React, {useState} from 'react';\r\nimport SockJS from 'sockjs-client';\r\nimport {over} from 'stompjs';\r\nimport GamePage from './GamePage';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\nimport {useNavigate} from \"react-router-dom\";\r\n\r\n\r\n\r\n\r\ninterface message {\r\n  receiver:string;\r\n  sender:string;\r\n  message:string;\r\n}\r\n\r\n\r\nvar serverURL: string = 'http://localhost:8082';\r\nvar stompClient: any = null;\r\nvar gameID:string= \"\";\r\nconst SearchingPage = () => {\r\n    const [userName, setUserName] = useState<string>(\"\");\r\n    const [isConnected, setIsConnected] = useState<boolean>(false);\r\n    const [isEnemyFound, setIsEnemyFound] = useState<boolean>(false);\r\n    const [points, setPoints] = useState<number>(0);\r\n    const [enemyPoints, setEnemyPoints] = useState<number>(0);\r\n\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    let navigate = useNavigate();\r\n\r\n\r\n  const connectToServer= () => {\r\n    dispatch({type:\"CHANGE_NAME\", payload: userName});\r\n    dispatch({type:\"SET_SERVER_URL\", payload: serverURL});\r\n    let Sock=new SockJS(serverURL + '/ws');\r\n    stompClient = over(Sock);\r\n    stompClient.connect({}, onConnected);\r\n\r\n  }\r\n  const onConnected = () => {\r\n    setIsConnected(true);\r\n    stompClient.subscribe('/user/' + userName + '/private', onMessageReceived);\r\n\r\n  }\r\n\r\n  const onMessageReceived = (payload:any) => {\r\n\r\n    if(payload.body.includes(\"Found enemy\") ) {\r\n\r\n      gameID = payload.body.split(\":\")[1]; \r\n      dispatch({type:\"SET_GAME_ID\", payload: gameID});\r\n      let message:string = userName + \":\" + gameID;\r\n      setIsEnemyFound(true);\r\n      fetch(serverURL + '/button', {\r\n        method: 'PUT',\r\n        headers: {'Content-Type': 'text/plain',},\r\n        body: message,\r\n      });\r\n      navigate(\"/game\");\r\n    }\r\n    else if(payload.body.includes(\"Get data from server\")) {\r\n      let enemyName = payload.body.split(\":\")[1]; \r\n      fetch(serverURL + `/button/getPoints/${enemyName}/${gameID}`)\r\n      .then((res) => res.json())\r\n      .then((data:number ) => {\r\n        setEnemyPoints(data);\r\n      }).catch(console.error);\r\n    }\r\n  }\r\n\r\n\r\n  const startSearching = () => {\r\n    stompClient.send('/app/findEnemy', {}, userName);\r\n  }\r\n\r\n  const increase = () => {\r\n\r\n      let message:string = userName + \":\" + gameID;\r\n      fetch(serverURL + '/button', {\r\n        method: 'POST',\r\n        headers: {'Content-Type': 'text/plain',},\r\n        body: message,\r\n      });\r\n      fetch(serverURL + `/button/getPoints/${userName}/${gameID}`)\r\n      .then((res) => res.json())\r\n      .then((data:number ) => {\r\n        setPoints(data);\r\n      }).catch(console.error);\r\n      stompClient.send('/app/sendToEnemy', {}, userName);\r\n\r\n  }\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      {isEnemyFound?\r\n      <div>\r\n      </div>\r\n      :\r\n      <div>\r\n      {!isConnected? <div>connect to search</div>: <button onClick={startSearching}>search for opponent</button>}\r\n      <div>\r\n        {isConnected? <div> </div>:\r\n        <div>\r\n         <input id='user-name' placeholder='enter user name' value={userName} name='username' onChange={(event:any) => {setUserName(event.target.value)}}/>\r\n         <button onClick={connectToServer}>connect to server</button>\r\n        </div>\r\n        }\r\n      </div>\r\n\r\n      </div>\r\n      }\r\n\r\n\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\nexport default SearchingPage\r\n\r\n\r\n\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAGC,QAAQ,QAAO,OAAO;AACrC,OAAOC,MAAM,MAAM,eAAe;AAClC,SAAQC,IAAI,QAAO,SAAS;AAE5B,SAAQC,WAAW,QAAoB,aAAa;AACpD,SAAQC,WAAW,QAAO,kBAAkB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAY7C,IAAIC,SAAiB,GAAG,uBAAuB;AAC/C,IAAIC,WAAgB,GAAG,IAAI;AAC3B,IAAIC,MAAa,GAAE,EAAE;AACrB,MAAMC,aAAa,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACxB,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGb,QAAQ,CAAS,EAAE,CAAC;EACpD,MAAM,CAACc,WAAW,EAAEC,cAAc,CAAC,GAAGf,QAAQ,CAAU,KAAK,CAAC;EAC9D,MAAM,CAACgB,YAAY,EAAEC,eAAe,CAAC,GAAGjB,QAAQ,CAAU,KAAK,CAAC;EAChE,MAAM,CAACkB,MAAM,EAAEC,SAAS,CAAC,GAAGnB,QAAQ,CAAS,CAAC,CAAC;EAC/C,MAAM,CAACoB,WAAW,EAAEC,cAAc,CAAC,GAAGrB,QAAQ,CAAS,CAAC,CAAC;EAGzD,MAAMsB,QAAQ,GAAGnB,WAAW,CAAC,CAAC;EAE9B,IAAIoB,QAAQ,GAAGnB,WAAW,CAAC,CAAC;EAG9B,MAAMoB,eAAe,GAAEA,CAAA,KAAM;IAC3BF,QAAQ,CAAC;MAACG,IAAI,EAAC,aAAa;MAAEC,OAAO,EAAEd;IAAQ,CAAC,CAAC;IACjDU,QAAQ,CAAC;MAACG,IAAI,EAAC,gBAAgB;MAAEC,OAAO,EAAEnB;IAAS,CAAC,CAAC;IACrD,IAAIoB,IAAI,GAAC,IAAI1B,MAAM,CAACM,SAAS,GAAG,KAAK,CAAC;IACtCC,WAAW,GAAGN,IAAI,CAACyB,IAAI,CAAC;IACxBnB,WAAW,CAACoB,OAAO,CAAC,CAAC,CAAC,EAAEC,WAAW,CAAC;EAEtC,CAAC;EACD,MAAMA,WAAW,GAAGA,CAAA,KAAM;IACxBd,cAAc,CAAC,IAAI,CAAC;IACpBP,WAAW,CAACsB,SAAS,CAAC,QAAQ,GAAGlB,QAAQ,GAAG,UAAU,EAAEmB,iBAAiB,CAAC;EAE5E,CAAC;EAED,MAAMA,iBAAiB,GAAIL,OAAW,IAAK;IAEzC,IAAGA,OAAO,CAACM,IAAI,CAACC,QAAQ,CAAC,aAAa,CAAC,EAAG;MAExCxB,MAAM,GAAGiB,OAAO,CAACM,IAAI,CAACE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;MACnCZ,QAAQ,CAAC;QAACG,IAAI,EAAC,aAAa;QAAEC,OAAO,EAAEjB;MAAM,CAAC,CAAC;MAC/C,IAAI0B,OAAc,GAAGvB,QAAQ,GAAG,GAAG,GAAGH,MAAM;MAC5CQ,eAAe,CAAC,IAAI,CAAC;MACrBmB,KAAK,CAAC7B,SAAS,GAAG,SAAS,EAAE;QAC3B8B,MAAM,EAAE,KAAK;QACbC,OAAO,EAAE;UAAC,cAAc,EAAE;QAAa,CAAC;QACxCN,IAAI,EAAEG;MACR,CAAC,CAAC;MACFZ,QAAQ,CAAC,OAAO,CAAC;IACnB,CAAC,MACI,IAAGG,OAAO,CAACM,IAAI,CAACC,QAAQ,CAAC,sBAAsB,CAAC,EAAE;MACrD,IAAIM,SAAS,GAAGb,OAAO,CAACM,IAAI,CAACE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;MAC1CE,KAAK,CAAC7B,SAAS,GAAI,qBAAoBgC,SAAU,IAAG9B,MAAO,EAAC,CAAC,CAC5D+B,IAAI,CAAEC,GAAG,IAAKA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CACzBF,IAAI,CAAEG,IAAW,IAAM;QACtBtB,cAAc,CAACsB,IAAI,CAAC;MACtB,CAAC,CAAC,CAACC,KAAK,CAACC,OAAO,CAACC,KAAK,CAAC;IACzB;EACF,CAAC;EAGD,MAAMC,cAAc,GAAGA,CAAA,KAAM;IAC3BvC,WAAW,CAACwC,IAAI,CAAC,gBAAgB,EAAE,CAAC,CAAC,EAAEpC,QAAQ,CAAC;EAClD,CAAC;EAED,MAAMqC,QAAQ,GAAGA,CAAA,KAAM;IAEnB,IAAId,OAAc,GAAGvB,QAAQ,GAAG,GAAG,GAAGH,MAAM;IAC5C2B,KAAK,CAAC7B,SAAS,GAAG,SAAS,EAAE;MAC3B8B,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QAAC,cAAc,EAAE;MAAa,CAAC;MACxCN,IAAI,EAAEG;IACR,CAAC,CAAC;IACFC,KAAK,CAAC7B,SAAS,GAAI,qBAAoBK,QAAS,IAAGH,MAAO,EAAC,CAAC,CAC3D+B,IAAI,CAAEC,GAAG,IAAKA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CACzBF,IAAI,CAAEG,IAAW,IAAM;MACtBxB,SAAS,CAACwB,IAAI,CAAC;IACjB,CAAC,CAAC,CAACC,KAAK,CAACC,OAAO,CAACC,KAAK,CAAC;IACvBtC,WAAW,CAACwC,IAAI,CAAC,kBAAkB,EAAE,CAAC,CAAC,EAAEpC,QAAQ,CAAC;EAEtD,CAAC;EAED,oBACEN,OAAA;IAAK4C,SAAS,EAAC,KAAK;IAAAC,QAAA,EACjBnC,YAAY,gBACbV,OAAA;MAAA8C,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACK,CAAC,gBAENjD,OAAA;MAAA6C,QAAA,GACC,CAACrC,WAAW,gBAAER,OAAA;QAAA6C,QAAA,EAAK;MAAiB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,gBAAEjD,OAAA;QAAQkD,OAAO,EAAET,cAAe;QAAAI,QAAA,EAAC;MAAmB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eAC1GjD,OAAA;QAAA6C,QAAA,EACGrC,WAAW,gBAAER,OAAA;UAAA6C,QAAA,EAAK;QAAC;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAAC,gBAC1BjD,OAAA;UAAA6C,QAAA,gBACC7C,OAAA;YAAOmD,EAAE,EAAC,WAAW;YAACC,WAAW,EAAC,iBAAiB;YAACC,KAAK,EAAE/C,QAAS;YAACgD,IAAI,EAAC,UAAU;YAACC,QAAQ,EAAGC,KAAS,IAAK;cAACjD,WAAW,CAACiD,KAAK,CAACC,MAAM,CAACJ,KAAK,CAAC;YAAA;UAAE;YAAAP,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAC,CAAC,eAClJjD,OAAA;YAAQkD,OAAO,EAAEhC,eAAgB;YAAA2B,QAAA,EAAC;UAAiB;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACxD;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAEH,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAED;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAIH,CAAC;AAEV,CAAC;AAAA5C,EAAA,CAjGKD,aAAa;EAAA,QAQEP,WAAW,EAEbC,WAAW;AAAA;AAAA4D,EAAA,GAVxBtD,aAAa;AAoGnB,eAAeA,aAAa;AAAA,IAAAsD,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}